(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";var createArtificialNeuralNetwork=function(r){if(r.length<2)throw new Error("received invalid number of layer");if(r[0]<=0)throw new Error("received invalid number of inputs");for(var t=1;t<r.length-1;++t)if(r[t]<=0)throw new Error("received invalid number of hidden neurons");if(r[r.length-1]<=0)throw new Error("received invalid number of outputs");this._topology=r,this._totalWeights=0;for(var e=r[0],t=1;t<r.length-1;++t){var i=r[t];this._totalWeights+=e*i,e=i}this._totalWeights+=e*r[r.length-1];var e=r[0];this._layerHidden=[];for(var t=1;t<r.length-1;++t){for(var a=r[t],o=[],n=0;n<a;++n){for(var h=[],l=0;l<e;++l)h.push(Math.random()-Math.random());o.push(h)}this._layerHidden.push(o),e=a}this._layerOutput=[];for(var t=0;t<r[r.length-1];++t){for(var h=[],n=0;n<e;++n)h.push(Math.random()-Math.random());this._layerOutput.push(h)}};createArtificialNeuralNetwork.prototype.process=function(r){if(r.length!=this._topology[0])throw new Error("received invalid number of inputs");var t=[],e=r;for(var i in this._layerHidden){var a=this._layerHidden[i],o=[];for(var n in a){var h=0;for(var l in e)h+=e[l]*a[n][l];o.push(h)}e=o}for(var i in this._layerOutput){var h=0;for(var n in e)h+=e[n]*this._layerOutput[i][n];t.push(h)}return t},createArtificialNeuralNetwork.prototype.setWeights=function(r){if(r.length!=this._totalWeights)throw new Error("received invalid number of weights");var t=0;for(var e in this._layerHidden)for(var i in this._layerHidden[e])for(var a in this._layerHidden[e][i])this._layerHidden[e][i][a]=r[t++];for(var e in this._layerOutput)for(var i in this._layerOutput[e])this._layerOutput[e][i]=r[t++]},createArtificialNeuralNetwork.prototype.getWeights=function(){var r=[];for(var t in this._layerHidden)for(var e in this._layerHidden[t])for(var i in this._layerHidden[t][e])r.push(this._layerHidden[t][e][i]);for(var t in this._layerOutput)for(var e in this._layerOutput[t])r.push(this._layerOutput[t][e]);return r},module.exports=createArtificialNeuralNetwork;
},{}],2:[function(require,module,exports){
"use strict";var createArtificialNeuralNetwork=require("./ArtificialNeuralNetwork.js"),createLogger=require("../utils/Logger.js"),createGeneticAlgo=function(e,t){this._current_id=0,this._ANNs=[];for(var s=0;s<e;++s)this._ANNs.push(new createArtificialNeuralNetwork(t));this._genomes=[];for(var s=0;s<e;++s)this._genomes.push({id:this._current_id++,fitness:0,weights:this._ANNs[s].getWeights()});this._current_generation=1,this._best_fitness=0,this._alpha_genome={fitness:0},this._logger=new createLogger("logger")};createGeneticAlgo.prototype.BreedPopulation=function(){var e=this._getBestGenomes(6),t=[];if(this._best_fitness<e[0].fitness&&(this._best_fitness=e[0].fitness),this._best_fitness>this._alpha_genome.fitness)this._alpha_genome=e[0],this._is_a_great_generation=!0,this._logger.push_line("generation: "+this._current_generation+" => promoted a new genome alpha");else{var s={id:this._alpha_genome.id,fitness:0,weights:[]};for(var i in this._alpha_genome.weights)s.weights.push(this._alpha_genome.weights[i]);this._mutate(s),t.push(s),this._logger.push_line("generation: "+this._current_generation+" => genome alpha is being reused")}var s={id:e[0].id,fitness:0,weights:[]};for(var i in e[0].weights)s.weights.push(e[0].weights[i]);this._mutate(s),t.push(s);for(var h=0;h<e.length;++h)for(var r=h+1;r<e.length;++r){var n={},g={};this._crossBreed(e[h],e[r],n,g),this._mutate(n),this._mutate(g),t.length<this._genomes.length&&t.push(n),t.length<this._genomes.length&&t.push(g)}for(var o=this._genomes.length-t.length,a=this._ANNs[0].getWeights().length,h=0;h<o;h++){for(var _={id:this._current_id++,fitness:0,weights:[]},r=0;r<a;r++)_.weights.push(Math.random()-Math.random());t.push(_)}this._genomes=t,++this._current_generation;for(var h=0;h<this._genomes.length;++h)this._ANNs[h].setWeights(this._genomes[h].weights)},createGeneticAlgo.prototype._getBestGenomes=function(e){e=Math.min(this._genomes.length,e);for(var t=[];t.length<e;){for(var s=0,i=-1,h=0;h<this._genomes.length;h++)if(this._genomes[h].fitness>s){for(var r=!1,n=0;n<t.length;n++)if(t[n].id==this._genomes[h].id){r=!0;break}if(r)continue;i=h,s=this._genomes[i].fitness}i!=-1&&t.push(this._genomes[i])}return t},createGeneticAlgo.prototype._crossBreed=function(e,t,s,i){var h=e.weights.length,r=Math.floor(Math.random()*h);s.id=this._current_id++,s.weights=[],i.id=this._current_id++,i.weights=[];for(var n=0;n<r;n++)s.weights[n]=e.weights[n],i.weights[n]=t.weights[n];for(var n=r;n<h;n++)s.weights[n]=t.weights[n],i.weights[n]=e.weights[n]},createGeneticAlgo.prototype._mutate=function(e){for(var t=0;t<e.weights.length;++t)Math.random()<.1&&(e.weights[t]+=.2*(Math.random()-Math.random()))},module.exports=createGeneticAlgo;

},{"../utils/Logger.js":8,"./ArtificialNeuralNetwork.js":1}],3:[function(require,module,exports){
"use strict";var createRenderer=function(t){if(this._canvas=document.getElementById(t),!this._canvas)throw new Error("failed to get the canvas");this._ctx=this._canvas.getContext("2d"),this._center_x=0,this._center_y=0};createRenderer.prototype.clear=function(t,e,i,r){this._ctx.fillStyle="black";var n=t||0,c=e||0,s=i||800,_=r||600;this._ctx.fillRect(n,c,s,_)},createRenderer.prototype.setCenter=function(t,e){this._center_x=t,this._center_y=e},createRenderer.prototype.drawLine=function(t,e,i,r,n,c){this._ctx.strokeStyle=n,this._ctx.lineWidth=c||1,this._ctx.beginPath(),this._ctx.moveTo(this._center_x+t,this._center_y+e),this._ctx.lineTo(this._center_x+i,this._center_y+r),this._ctx.stroke()},createRenderer.prototype.drawThickLine=function(t,e,i,r,n){this.drawLine(t,e,i,r,n,4)},createRenderer.prototype.drawLineStrip=function(t,e,i){this._ctx.strokeStyle=e,this._ctx.lineWidth=i||1,this._ctx.beginPath(),this._ctx.moveTo(this._center_x+t[0].x,this._center_y+t[0].y);for(var r=1;r<t.length;++r)this._ctx.lineTo(this._center_x+t[r].x,this._center_y+t[r].y);this._ctx.stroke()},createRenderer.prototype.drawLines=function(t,e,i){this._ctx.strokeStyle=e,this._ctx.lineWidth=i||1,this._ctx.beginPath();for(var r=0;r<t.length;++r)this._ctx.moveTo(this._center_x+t[r].p1.x,this._center_y+t[r].p1.y),this._ctx.lineTo(this._center_x+t[r].p2.x,this._center_y+t[r].p2.y);this._ctx.stroke()},createRenderer.prototype.drawPoint=function(t,e,i,r){var n=10;this.drawLine(t-n,e-n,t+n,e+n,i,r),this.drawLine(t-n,e+n,t+n,e-n,i,r)},createRenderer.prototype.drawCircle=function(t,e,i,r){this._ctx.beginPath(),this._ctx.arc(this._center_x+t,this._center_y+e,i,0,2*Math.PI,!1),this._ctx.fillStyle=r,this._ctx.fill()},module.exports=createRenderer;

},{}],4:[function(require,module,exports){
"use strict";function tick(e){function r(e,r,i){for(var t=e._position,n=e._angle,a=25,s=12.5,o=[{x:t.x-a,y:t.y-s},{x:t.x+a,y:t.y-s},{x:t.x+a,y:t.y+s},{x:t.x-a,y:t.y+s}],l=0;l<4;++l)o[l]=utils.rotateVec2(o[l],t,n);var f=e._alive?r:"#ff0000";if(Renderer.drawLine(o[0].x,o[0].y,o[1].x,o[1].y,f,6),Renderer.drawLine(o[1].x,o[1].y,o[2].x,o[2].y,f,6),Renderer.drawLine(o[2].x,o[2].y,o[3].x,o[3].y,f,6),Renderer.drawLine(o[3].x,o[3].y,o[0].x,o[0].y,f,6),e._alive&&i)for(var c=e._sensors,l=0;l<c.length;++l){var _=c[l],u={x:_.line.p1.x+(_.line.p2.x-_.line.p1.x)*_.value,y:_.line.p1.y+(_.line.p2.y-_.line.p1.y)*_.value};Renderer.drawLine(_.line.p1.x,_.line.p1.y,u.x,u.y,"#8888ff",2),Renderer.drawPoint(u.x,u.y,"#ffff00",2)}}myFpsmeter.tickStart(),window.requestAnimFrame(tick);for(var i=0;i<3;++i)simulation.update(.25);var t=0,n=0;if(simulation._cars&&simulation._cars.length>0){for(var a=0;a<simulation._cars.length&&!simulation._cars[a]._alive;++a);a<simulation._cars.length&&(t=simulation._cars[a]._position.x,n=simulation._cars[a]._position.y)}var s=t-center_x,o=n-center_y;center_x+=.1*s,center_y+=.1*o,Renderer.setCenter(-center_x+500,-center_y+300),Renderer.clear(),Renderer.drawLines(simulation._circuit._checkpoints,"#ffffff",3),Renderer.drawLines(simulation._circuit._walls,"#0000ff",2),Renderer.drawPoint(simulation._circuit._start_position.x,simulation._circuit._start_position.y,"#ffffff",2),Renderer.drawLine(simulation._circuit._start_position.x,simulation._circuit._start_position.y,simulation._circuit._start_position.x+50*Math.cos(simulation._circuit._start_angle),simulation._circuit._start_position.y+50*Math.sin(simulation._circuit._start_angle),"#ffffff",2);var l=simulation._cars;for(a in l){var f=l[a];r(f,"#00ff00",!0)}for(var c=["#ffffff","#00ff00","#00cc00","#009900","#006600","#003300"],_=0,u=simulation._trails,a=u.length-1;a>=0;--a){var m=u[a],d=c[_++];Renderer.drawLineStrip(m,d)}var y=null,v=simulation._geneticAlgo._genomes;if(v.length>0){for(var a=0;a<v.length&&!v[a].car._alive;++a);a<v.length&&(y=v[a].weights)}if(y){Renderer.setCenter(50,150);for(var x=0,p=simulation._ann_topology,a=1;a<p.length;++a)for(var w=p[a-1],R=p[a],g=185*(1-w/5),h=185*(1-R/5),L=0;L<w;++L)for(var F=0;F<R;++F){var q=75*(a-1),k=y[x++],S=10*k;S<0&&(S=-S),S<1&&(S=1),k>0?Renderer.drawLine(q,g+75*L,q+75,h+75*F,"#ff0000",S):Renderer.drawLine(q,g+75*L,q+75,h+75*F,"#0000ff",S)}for(var a=0;a<p.length;++a)for(var R=p[a],h=185*(1-R/5),F=0;F<R;++F){var q=75*a;Renderer.drawCircle(q,h+75*F,13,"#ffff00"),Renderer.drawCircle(q,h+75*F,10,"#00ff00")}}myFpsmeter.tick()}require("../lib/requestAnimationFrame"),require("../lib/fpsmeter");var createRenderer=require("./graphic/Renderer.js"),utils=require("./utils/collision.js"),createSimulation=require("./simulation/simulation.js"),Renderer=new createRenderer("main-canvas"),simulation=new createSimulation("circuit-data"),myFpsmeter_elem=document.getElementById("canvasesdiv"),myFpsmeter=new window.FPSMeter(myFpsmeter_elem,window.FPSMeter.theme.transparent),center_x=0,center_y=0;tick();
},{"../lib/fpsmeter":10,"../lib/requestAnimationFrame":11,"./graphic/Renderer.js":3,"./simulation/simulation.js":7,"./utils/collision.js":9}],5:[function(require,module,exports){
"use strict";var utils=require("../utils/collision.js"),createCar=function(t){this._position={x:0,y:0},this._angle=0,this._alive=!0,this._fitness=0,this._min_updates=50,this._total_update=0,this._trail=[],this._updateSensors()};createCar.prototype.update=function(t,i,s){if(this._alive){this._min_updates>0&&--this._min_updates,0==this._min_updates&&(this._min_updates=50,this._alive=!1);for(var e=[],o=0;o<this._sensors.length;++o)e.push(this._sensors[o].value);var n=s.process(e),a=n[0],h=n[1];isNaN(a)&&(a=0),isNaN(h)&&(h=0),a=Math.min(Math.PI/32,Math.max(-Math.PI/32,a)),this._angle+=a*t;var l=30*h;l=Math.min(15,Math.max(-10,l)),this._position.x+=l*Math.cos(this._angle)*t,this._position.y+=l*Math.sin(this._angle)*t,this._trail.push({x:this._position.x,y:this._position.y}),this._collideWalls(i),this._updateSensors(),this._collideSensors(i),this._collideCheckpoints(),++this._total_update}},createCar.prototype._collideWalls=function(t){for(var i=0;i<t.length;++i)if(utils.CollisionSegmentCercle(t[i].p1,t[i].p2,this._position,10)){this._alive=!1;break}},createCar.prototype._updateSensors=function(t){var i=[-Math.PI/4,-Math.PI/8,0,Math.PI/8,Math.PI/4];this._sensors=[];for(var s=0;s<i.length;++s)this._sensors.push({line:{p1:{x:0,y:0},p2:{x:200*Math.cos(i[s]),y:200*Math.sin(i[s])}},value:1});for(var s=0;s<this._sensors.length;++s){var e=this._sensors[s];e.line.p1.x+=this._position.x,e.line.p2.x+=this._position.x,e.line.p1.y+=this._position.y,e.line.p2.y+=this._position.y,e.line.p1=utils.rotateVec2(e.line.p1,this._position,this._angle),e.line.p2=utils.rotateVec2(e.line.p2,this._position,this._angle)}},createCar.prototype._collideSensors=function(t){for(var i=0;i<this._sensors.length;++i){var s=this._sensors[i];s.value=1;for(var e=0;e<t.length;++e){var o=t[e],n=utils.CollisionSegSeg_partial(s.line.p1,s.line.p2,o.p1,o.p2);n>=0&&n<1&&s.value>n&&(s.value=n)}}},createCar.prototype._collideCheckpoints=function(){for(var t=0;t<this._checkpoints.length;){if(utils.CollisionSegmentCercle(this._checkpoints[t].p1,this._checkpoints[t].p2,this._position,5)){this._checkpoints.splice(t,1),this._min_updates=50,++this._fitness;break}++t}0==this._checkpoints.length&&(this._fitness+=1e3/this._total_update,this._alive=!1)},module.exports=createCar;
},{"../utils/collision.js":9}],6:[function(require,module,exports){
"use strict";var utils=require("../utils/collision.js"),createCircuit=function(t){var s=document.getElementById(t).innerHTML,p=JSON.parse(s);this._checkpoints=[];for(s in p)this._checkpoints.push({p1:{x:p[s][0],y:p[s][1]},p2:{x:p[s][2],y:p[s][3]}});this._walls=[];for(var i=1;i<this._checkpoints.length;++i)this._walls.push({p1:this._checkpoints[i-1].p1,p2:this._checkpoints[i].p1}),this._walls.push({p1:this._checkpoints[i-1].p2,p2:this._checkpoints[i].p2});var h=[];h.push(this._checkpoints[0]);for(var i=1;i<this._checkpoints.length;++i){for(var o=this._checkpoints[i-1],c=this._checkpoints[i],e=.25;e<1;e+=.25)h.push({p1:utils.lerp(o.p1,c.p1,e),p2:utils.lerp(o.p2,c.p2,e)});h.push(c)}this._checkpoints=h;for(var i=0;i<this._walls.length;++i)this._walls[i].p1=utils.lerp(this._walls[i].p1,this._walls[i].p2,-.01),this._walls[i].p2=utils.lerp(this._walls[i].p1,this._walls[i].p2,1.01);var o=this._checkpoints[0];this._start_position={x:o.p1.x+.5*(o.p2.x-o.p1.x),y:o.p1.y+.5*(o.p2.y-o.p1.y)};var c=this._checkpoints[1],_={x:c.p1.x+.5*(c.p2.x-c.p1.x),y:c.p1.y+.5*(c.p2.y-c.p1.y)};this._start_angle=Math.atan2(_.y-this._start_position.y,_.x-this._start_position.x);var o=this._checkpoints[this._checkpoints.length-1];this._stop_position={x:o.p1.x+.5*(o.p2.x-o.p1.x),y:o.p1.y+.5*(o.p2.y-o.p1.y)};var o=this._checkpoints[this._checkpoints.length-2],_={x:c.p1.x+.5*(c.p2.x-c.p1.x),y:c.p1.y+.5*(c.p2.y-c.p1.y)};this._stop_angle=Math.atan2(_.y-this._stop_position.y,_.x-this._stop_position.x)};module.exports=createCircuit;

},{"../utils/collision.js":9}],7:[function(require,module,exports){
"use strict";var createCircuit=require("./circuit.js"),createCar=require("./car.js"),createGeneticAlgo=require("../ai/geneticAlgo.js"),createSimulation=function(t){this._circuit=new createCircuit(t);var i=40;this._ann_topology=[5,4,3,2],this._geneticAlgo=new createGeneticAlgo(i,this._ann_topology),this._cars=[];for(var s=0;s<i;++s){var e=new createCar;this._geneticAlgo._genomes[s].car=e,e._position={x:this._circuit._start_position.x,y:this._circuit._start_position.y},e._angle=this._circuit._start_angle,e._checkpoints=[];for(var _=0;_<this._circuit._checkpoints.length;++_)e._checkpoints.push(this._circuit._checkpoints[_]);this._cars.push(e)}this._trails=[],this._start_to_stop_sens=!0};createSimulation.prototype.update=function(t){for(var i=!1,s=0;s<this._cars.length;++s)this._cars[s]._alive&&(this._cars[s].update(t,this._circuit._walls,this._geneticAlgo._ANNs[s]),i=!0);if(!i){for(var s=0;s<this._cars.length;++s)this._geneticAlgo._genomes[s].fitness=this._cars[s]._fitness;this._geneticAlgo.BreedPopulation(),this._geneticAlgo._is_a_great_generation&&(this._geneticAlgo._is_a_great_generation=!1,this._trails.push(this._geneticAlgo._alpha_genome.car._trail),this._trails.length>5&&this._trails.splice(0,1)),this._start_to_stop_sens=!this._start_to_stop_sens;for(var s=0;s<this._cars.length;++s){var e=this._cars[s];this._geneticAlgo._genomes[s].car=e,e._position={x:this._circuit._start_position.x,y:this._circuit._start_position.y},e._angle=this._circuit._start_angle,e._checkpoints=[];for(var _ in this._circuit._checkpoints)e._checkpoints.push(this._circuit._checkpoints[_]);e._alive=!0,e._fitness=0,e._total_update=0,e._trail=[],e._min_updates=100}}},module.exports=createSimulation;

},{"../ai/geneticAlgo.js":2,"./car.js":5,"./circuit.js":6}],8:[function(require,module,exports){
"use strict";var createLogger=function(e){if(this._elem=document.getElementById(e),!this._elem)throw new Error("failed to get the textarea");this._elem.innerHTML="logger initialised",this._elem.cols=60,this._elem.rows=30,this._arr_data=[],this._max_data=30};createLogger.prototype.clear=function(){this._elem.innerHTML="",this._arr_data=[]},createLogger.prototype.push_line=function(e){this._arr_data.push(e),this._arr_data.length>=this._max_data&&this._arr_data.shift(),this._elem.innerHTML="";for(var t in this._arr_data)this._elem.innerHTML+=this._arr_data[t]+"\n"},module.exports=createLogger;

},{}],9:[function(require,module,exports){
"use strict";var self={};self.CollisionDroiteSeg=function(x,y,e,r){var l={},i={},n={};return n.x=y.x-x.x,n.y=y.y-x.y,i.x=r.x-x.x,i.y=r.y-x.y,l.x=e.x-x.x,l.y=e.y-x.y,(n.x*i.y-n.y*i.x)*(n.x*l.y-n.y*l.x)<0},self.CollisionSegSeg_partial=function(x,y,e,r){if(!self.CollisionDroiteSeg(x,y,e,r))return 1;var l={},i={};return l.x=y.x-x.x,l.y=y.y-x.y,i.x=r.x-e.x,i.y=r.y-e.y,-(x.x*i.y-e.x*i.y-i.x*x.y+i.x*e.y)/(l.x*i.y-l.y*i.x)},self.CollisionSegSeg=function(x,y,e,r){var l=self.CollisionSegSeg_partial(x,y,e,r);return!(l<0||l>1)},self.CollisionPointCercle=function(x,y,e){var r=(x.x-y.x)*(x.x-y.x)+(x.y-y.y)*(x.y-y.y);return r<=e*e},self.CollisionDroiteCercle_BBox=function(x,y,e,r){var l={x:Math.min(x.x,y.x),y:Math.min(x.y,y.y)},i={x:Math.max(x.x,y.x),y:Math.max(x.y,y.y)},n={x:e.x-r,y:e.y-r},o={x:e.x+r,y:e.y+r};return!(i.x<n.x||l.x>o.x||i.y<n.y||l.y>o.y)},self.CollisionDroiteCercle=function(x,y,e,r){if(!self.CollisionDroiteCercle_BBox(x,y,e,r))return!1;var l={x:y.x-x.x,y:y.y-x.y},i={x:e.x-x.x,y:e.y-x.y},n=l.x*i.y-l.y*i.x;n<0&&(n=-n);var o=Math.sqrt(l.x*l.x+l.y*l.y),t=n/o;return t<r},self.CollisionSegmentCercle=function(x,y,e,r){if(0==self.CollisionDroiteCercle(x,y,e,r))return!1;var l={},i={},n={};l.x=y.x-x.x,l.y=y.y-x.y,i.x=e.x-x.x,i.y=e.y-x.y,n.x=e.x-y.x,n.y=e.y-y.y;var o=l.x*i.x+l.y*i.y,t=-l.x*n.x+-l.y*n.y;return o>=0&&t>=0||!(!self.CollisionPointCercle(x,e,r)&&!self.CollisionPointCercle(y,e,r))},self.rotateVec2=function(x,y,e){var r={},l=Math.cos(e),i=Math.sin(e);return r.x=y.x+(x.x-y.x)*l+(x.y-y.y)*i,r.y=y.y+(x.x-y.x)*i-(x.y-y.y)*l,r},self.lerp=function(x,y,e){var r={};return r.x=x.x+(y.x-x.x)*e,r.y=x.y+(y.y-x.y)*e,r},module.exports=self;

},{}],10:[function(require,module,exports){
!function(t,n){"use strict";function e(t){return document.createElement(t)}function o(t,n){for(var e in n)try{t.style[e]=n[e]}catch(t){}return t}function a(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function i(t,n){if("array"!==a(n))return-1;if(n.indexOf)return n.indexOf(t);for(var e=0,o=n.length;e<o;e++)if(n[e]===t)return e;return-1}function r(){var t=arguments;for(var n in t[1])if(t[1].hasOwnProperty(n))switch(a(t[1][n])){case"object":t[0][n]=r({},t[0][n],t[1][n]);break;case"array":t[0][n]=t[1][n].slice(0);break;default:t[0][n]=t[1][n]}return t.length>2?r.apply(null,[t[0]].concat(Array.prototype.slice.call(t,2))):t[0]}function h(t,n,e){var o,a,i,r,h,s,u,c,p;return r=e<=.5?e*(1+n):e+n-e*n,0===r?"#000":(h=2*e-r,s=(r-h)/r,t*=6,u=Math.floor(t),c=t-u,p=r*s*c,0===u||6===u?(o=r,a=h+p,i=h):1===u?(o=r-p,a=r,i=h):2===u?(o=h,a=r,i=h+p):3===u?(o=h,a=r-p,i=r):4===u?(o=h+p,a=h,i=r):(o=r,a=h,i=r-p),"#"+l(o)+l(a)+l(i))}function l(t){return t=Math.round(255*t).toString(16),1===t.length?"0"+t:t}function s(t,n,e,o){t.addEventListener?t[o?"removeEventListener":"addEventListener"](n,e,!1):t.attachEvent&&t[o?"detachEvent":"attachEvent"]("on"+n,e)}function u(t,l){function x(){for(j=D.history;j--;)K[j]=0===j?q.fps:K[j-1],Q[j]=0===j?q.duration:Q[j-1]}function b(t,n,e,o){return z[0|t][Math.round(Math.min((n-e)/(o-e)*B,B))]}function w(){L.legend.fps!==U&&(L.legend.fps=U,L.legend[g]=U?"FPS":"ms"),T=U?q.fps:q.duration,L.count[g]=T>999?"999+":T.toFixed(T>99?0:D.decimals)}function y(){if(A=c(),J<A-D.threshold&&(q.fps-=q.fps/Math.max(1,60*D.smoothing/D.interval),q.duration=1e3/q.fps),x(),w(),D.heat){if(N.length)for(j=N.length;j--;)N[j].el.style[M[N[j].name].heatOn]=U?b(M[N[j].name].heatmap,q.fps,0,D.maxFps):b(M[N[j].name].heatmap,q.duration,D.threshold,0);if(L.graph&&M.column.heatOn)for(j=R.length;j--;)R[j].style[M.column.heatOn]=U?b(M.column.heatmap,K[j],0,D.maxFps):b(M.column.heatmap,Q[j],D.threshold,0)}if(L.graph)for(I=0;I<D.history;I++)R[I].style.height=(U?K[I]?Math.round(H/D.maxFps*Math.min(K[I],D.maxFps)):0:Q[I]?Math.round(H/D.threshold*Math.min(Q[I],D.threshold)):0)+"px"}function v(){D.interval<20?(E=d(v),y()):(E=setTimeout(v,D.interval),P=d(y))}function k(t){t=t||window.event,t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),q.toggle()}function O(){D.toggleOn&&s(L.container,D.toggleOn,k,1),t.removeChild(L.container)}function S(){if(M=u.theme[D.theme],z=M.compiledHeatmaps||[],!z.length&&M.heatmaps.length){for(I=0;I<M.heatmaps.length;I++)for(z[I]=[],j=0;j<=B;j++)z[I][j]=h(.33/B*j,M.heatmaps[I].saturation,M.heatmaps[I].lightness);M.compiledHeatmaps=z}}function F(){L.container&&O(),S(),L.container=o(e("div"),M.container),L.count=L.container.appendChild(o(e("div"),M.count)),L.legend=L.container.appendChild(o(e("div"),M.legend)),L.graph=D.graph?L.container.appendChild(o(e("div"),M.graph)):0,N.length=0;for(var n in L)L[n]&&M[n].heatOn&&N.push({name:n,el:L[n]});if(R.length=0,L.graph)for(L.graph.style.width=D.history*M.column.width+(D.history-1)*M.column.spacing+"px",j=0;j<D.history;j++)R[j]=L.graph.appendChild(o(e("div"),M.column)),R[j].style.position="absolute",R[j].style.bottom=0,R[j].style.right=j*M.column.width+j*M.column.spacing+"px",R[j].style.width=M.column.width+"px",R[j].style.height="0px";C(),w(),t.appendChild(L.container),L.graph&&(H=L.graph.clientHeight),D.toggleOn&&("click"===D.toggleOn&&(L.container.style.cursor="pointer"),s(L.container,D.toggleOn,k))}function C(){o(L.container,D)}"object"===a(t)&&t.nodeType===n&&(l=t,t=document.body),t||(t=document.body);var M,z,A,E,P,H,T,j,I,q=this,D=r({},u.defaults,l||{}),L={},R=[],B=100,N=[],V=0,W=D.threshold,G=0,J=c()-W,K=[],Q=[],U="fps"===D.show;q.options=D,q.fps=0,q.duration=0,q.isPaused=0,q.tickStart=function(){G=c()},q.tick=function(){A=c(),V=A-J,W+=(V-W)/D.smoothing,q.fps=1e3/W,q.duration=G<J?W:A-G,J=A},q.pause=function(){return E&&(q.isPaused=1,clearTimeout(E),p(E),p(P),E=P=0),q},q.resume=function(){return E||(q.isPaused=0,v()),q},q.set=function(t,n){return D[t]=n,U="fps"===D.show,i(t,f)!==-1&&F(),i(t,m)!==-1&&C(),q},q.showDuration=function(){return q.set("show","ms"),q},q.showFps=function(){return q.set("show","fps"),q},q.toggle=function(){return q.set("show",U?"ms":"fps"),q},q.hide=function(){return q.pause(),L.container.style.display="none",q},q.show=function(){return q.resume(),L.container.style.display="block",q},q.destroy=function(){q.pause(),O(),q.tick=q.tickStart=function(){}},function(){F(),v()}()}var c;!function(){var n=t.performance;if(n&&(n.now||n.webkitNow)){var e=n.now?"now":"webkitNow";c=n[e].bind(n)}else c=function(){return+new Date}}();var p=t.cancelAnimationFrame||t.cancelRequestAnimationFrame,d=t.requestAnimationFrame;!function(){for(var n=["moz","webkit","o"],e=0,o=0,a=n.length;o<a&&!p;++o)p=t[n[o]+"CancelAnimationFrame"]||t[n[o]+"CancelRequestAnimationFrame"],d=p&&t[n[o]+"RequestAnimationFrame"];p||(d=function(n){var o=c(),a=Math.max(0,16-(o-e));return e=o+a,t.setTimeout(function(){n(o+a)},a)},p=function(t){clearTimeout(t)})}();var g="string"===a(document.createElement("div").textContent)?"textContent":"innerText";u.extend=r,window.FPSMeter=u,u.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var f=["toggleOn","theme","heat","graph","history"],m=["position","zIndex","left","top","right","bottom","margin"]}(window),function(t,n,e){"use strict";n.theme={};var o=n.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};n.theme.dark=n.extend({},o,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),n.theme.light=n.extend({},o,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),n.theme.colorful=n.extend({},o,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),n.theme.transparent=n.extend({},o,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter);
},{}],11:[function(require,module,exports){
window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,n){window.setTimeout(e,1e3/60)}}();

},{}]},{},[4]);
